The core of the raytracer logic lives here, without any spark specifics.